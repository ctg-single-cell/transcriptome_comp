# Project: Transcriptome Comp
# Created by: Fallon Ratner
# Date: 30-03-2023

library(ggplot2)
library(dplyr)


#Set working directory

setwd("C:/Users/fallo/Documents/Internship_2023/transcriptome_comp/output")

# Read the CSV file for Velasco & Poliodaskis
combo1 <- read.csv("proportion_velasco_polio.csv")
head(combo1)

#remove first column
combo1 <- combo1[, -1]

#Make plots for the counts of each dataset
#Subset the dataframes

mon3 <- combo1[combo1$Group %in% c("3months"), ]
head(mon3)

#Make a bar plot for 3months and save as pdf

pdf("count_velasco_3months_v2.pdf")


ct3 <- ggplot(mon3, aes(y=Count,x = reorder(CellType, -Count), fill=Group)) + 
    geom_col()
    
ct3 + labs(title="Cell Count 3months Organoid", subtitle="Velasco et al., 2019", y = "Count") + theme(axis.title.x = element_blank()) + theme(legend.position = "none")  + scale_fill_manual(values=c("3months" = "#3399FF"))+ scale_color_manual(values = c("3months" = "#3399FF")) +
  theme(axis.text.x = element_text(angle=45, hjust=1)) + 
  theme(panel.background = element_blank(), axis.line = element_line(colour = "black"))
    
dev.off()

#############################################################################
mon6 <- combo1[combo1$Group %in% c("6months"), ]
head(mon6)

#Make a bar plot for 3months and save as pdf

pdf("count_velasco_6months_v2.pdf")

ct6 <- ggplot(mon6, aes(y=Count, x = reorder(CellType, -Count), fill=Group)) + 
    geom_col()
    
ct6 + labs(title="Cell Count 6months Organoid", subtitle="Velasco et al., 2019", y = "Count") + theme(axis.title.x = element_blank()) + theme(legend.position = "none")  + scale_fill_manual(values=c("6months" = "#000099"))+ scale_color_manual(values = c("6months" = "#000099")) +
  theme(axis.text.x = element_text(angle=45, hjust=1)) + 
  theme(panel.background = element_blank(), axis.line = element_line(colour = "black"))
    
dev.off()

#############################################################################
pol <- combo1[combo1$Group %in% c("17-18 GW"), ]
head(pol)

pdf("count_polio_v2.pdf")

ctp <- ggplot(pol, aes(y=Count, x = reorder(CellType, -Count), fill=Group)) + 
    geom_col()
    
ctp + labs(title="Cell Count 17-18 GW Cortex", subtitle="Polioudakis et al., 2019", y = "Count") + theme(axis.title.x = element_blank()) + theme(legend.position = "none")  + scale_fill_manual(values=c("17-18 GW" = "#FF3333"))+ scale_color_manual(values = c("17-18 GW" = "#FF3333")) +
  theme(axis.text.x = element_text(angle=45, hjust=1)) + 
  theme(panel.background = element_blank(), axis.line = element_line(colour = "black"))
    
dev.off()
########################################################################
#Make a stacked bar plot for vel and save as pdf
#Subset df for Velasco only
vel <- combo1[combo1$Group %in% c("3months", "6months"), ]
head(vel)

pdf("prop_velasco_v2.pdf")

barv <- ggplot(vel, aes(fill=Group, y=Percentage, x=CellType)) + 
    geom_bar(position="stack", stat="identity")
    
barv + labs(title="Percentage of Cell Type", subtitle="Velasco et al., 2019", y = "Proportion (%)") + theme(axis.title.x = element_blank()) + scale_fill_manual(values=c("#3399FF", "#000099"))+
  theme(axis.text.x = element_text(angle=45, hjust=1)) + 
  theme(panel.background = element_blank(), axis.line = element_line(colour = "black"))

dev.off()

########################################################################
#Make a stacked bar plot for combo1 and save as pdf

pdf("prop_velasco_poliov2.pdf")

bar <- ggplot(combo1, aes(fill=Group, y=Percentage, x=CellType)) + 
    geom_bar(position="stack", stat="identity")
    
bar + labs(title="Percentage of Cell Type", subtitle="Velasco et al., 2019 & Polioudakis et al., 2019", y = "Proportion (%)") + theme(axis.title.x = element_blank()) + scale_fill_manual(values=c("#FF3333",
                             "#3399FF",
                             "#000099"))+
  theme(axis.text.x = element_text(angle=45, hjust=1)) + 
  theme(panel.background = element_blank(), axis.line = element_line(colour = "black"))
    
dev.off()


########################################################################
#Subset df for oRG only
org <- combo1[grep("oRG", combo1$CellType), ]
head(org)

#Make a bar plot for org and save as pdf

pdf("prop_velasco_polio_org_v2.pdf")

bar2 <- ggplot(org, aes(y=Percentage, x=Group, fill=Group)) + 
    geom_col()
    
bar2 + labs(title="Percentage of Outer Radial Glia", subtitle="Velasco et al., 2019 & Polioudakis et al., 2019", y = "Proportion (%)") + theme(axis.title.x = element_blank()) + theme(legend.position = "none")  + scale_fill_manual(values=c("17-18 GW" ="#FF3333","3months" = "#3399FF","6months" = "#000099"))+ scale_color_manual(values = c("17-18 GW" = "#FF3333", "3months" = "#3399FF", "6months" = "#000099")) +
  theme(axis.text.x = element_text(angle=45, hjust=1)) + 
  theme(panel.background = element_blank(), axis.line = element_line(colour = "black"))
    
dev.off()

########################################################################
#Read in df for cycling only
cy <- read.csv("proportion_velasco_polio_cycling.csv")
  
#remove first column
cy <- cy[, -1]

#Make a bar plot for cycling and save as pdf

pdf("prop_velasco_polio_cy_v2.pdf")

bar3 <- ggplot(cy, aes(y=Percentage, x=Group, fill=Group)) + 
    geom_col()
    
bar3 + labs(title="Percentage of Cycling Cells", subtitle="Velasco et al., 2019 & Polioudakis et al., 2019", y = "Proportion (%)") + theme(axis.title.x = element_blank()) + theme(legend.position = "none")  + scale_fill_manual(values=c("17-18 GW" ="#FF3333","3months" = "#3399FF","6months" = "#000099"))+ scale_color_manual(values = c("17-18 GW" = "#FF3333", "3months" = "#3399FF", "6months" = "#000099")) +
  theme(axis.text.x = element_text(angle=45, hjust=1)) + 
  theme(panel.background = element_blank(), axis.line = element_line(colour = "black"))
    
dev.off()

########################################################################
#Subset df for IPs only
ip <- combo1[grep("IP", combo1$CellType), ]
head(ip)

#Make a bar plot for org and save as pdf

pdf("prop_velasco_polio_IP_v2.pdf")

bar4 <- ggplot(ip, aes(y=Percentage, x=Group, fill=Group)) + 
    geom_col()
    
bar4 + labs(title="Percentage of Intermediate Progenitors", subtitle="Velasco et al., 2019 & Polioudakis et al., 2019", y = "Proportion (%)") + theme(axis.title.x = element_blank()) + theme(legend.position = "none")  + scale_fill_manual(values=c("17-18 GW" ="#FF3333","3months" = "#3399FF","6months" = "#000099"))+ scale_color_manual(values = c("17-18 GW" = "#FF3333", "3months" = "#3399FF", "6months" = "#000099")) +
  theme(axis.text.x = element_text(angle=45, hjust=1)) + 
  theme(panel.background = element_blank(), axis.line = element_line(colour = "black"))
    
dev.off()