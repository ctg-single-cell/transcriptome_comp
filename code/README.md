# Project Title: transcriptome_comp
   
## This repo contains scripts relating to analyzing scRNAseq data.

### Creator: Fallon Ratner (f.t.ratner@student.vu.nl)

### Date: 06-06-2023

## Datasets Used:
    
    Velasco et al., 2019
        scRNAseq of PGP1 (iPSC cell line) - derived 3 & 6 month brain organoids
        Number of Cells in 3 months: 17,774
        Number of Cells in 6 months: 21,213
        Sequencing Technology: Illumina NextSeq 500, 10x Genomics
        Link: https://singlecell.broadinstitute.org/single_cell/study/SCP282/reproducible-brain-organoids#study-download

    Polioudakis et al., 2019
        scRNAseq of 17-18GW fetal neocortex
        Number of Cells: 40,000
        Sequencing Technology: Illumina HiSeq 2500, Drop-Seq
        Link:http://solo.bmap.ucla.edu/shiny/webapp/
    
    Herring et al., 2022
        snRNAseq of fetal Prefrontal Cortex (PFC)
        Number of Nuclei in ga22: 11,660 (10,466 cells kept)
        Total Genes ga22: 27,565
        Number of Nuclei in ga24: 10,809 (9,376 cells kept)
        Total Genes ga24: 27,737
        Number of Nuclei in ga34: 8,431 (6,738 cells kept)
        Total Genes ga34: 26,083
        Sequencing Technology: Illumina NextSeq 550
        Link: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE168408

## Documents:
    annotation_methods.xlsx
        Excel document containing different scRNAseq annotation methods and gene markers curated from the literature. This is used for the gs_list in the scType processing.
    
    gs_list_FR.xslx
        Excel document containing a list of gene markers for different cell types in the brain based on the literature and scType database which can be used as input in the sctype_annot.R script. 
 gs_listv4.xslx
        Excel document edited as of 26-05-23, containing a list of gene markers for different cell types in the brain based on the literature and scType database which can be used as input in the sctype_annot.R script. 
## Scripts:
    metatdata_annotation.py
        Python script to open and combine raw gene expression and metadata files from Velasco, Polioudakis, and Herring datasets. Then, the data is processed for calculating proportions and subsetted into dataframes to be used for visualization.
       
    sctype_annot.R
         R script to process scRNAseq data with Seurat then annotate cells using the scType tool based on their workflow. The ouput can then be further processed with the python script.
    
    sctype_wrangle.py
        Python script to manipulate dataframes generated by sctype_annot.R (ex: calculate proportions) to use for later visualizations. 
    
    bar_plot.R
        R script to plot cell types based on metadata (metadata_annotation.py) and the scType annotations (output of sctype_annot.R & sctype_processing.py)
    
    cell_typist_annot.py
        Python script to annotate cells based on the Cell Typist reference model: https://github.com/Teichlab/celltypist#usage. The datasets need to be normalized to be used as input for cell typist, so they are first normalized with scanpy. 
        
    scanorama_int.py
        Python script to integrate and batch correct the Herring datasets with Scanorama. First the individual datasets are read into scanpy objects then combine into one large scanpy object. Next, highly variable genes are selected which is used for Scanorama. The integrated object is saved as an h5ad file.
    
    int_sctype.R
       R script to annotate the Scanorama integrated Herring datasets from scanorama_int.py script. First the h5ad file is loaded then converted into a Seurat object using the zelkonverter package. Before using scType the data is pre-processed with seurat and the Scanorama umap is used to identify clusters. Next, scType is used to identify cell types in the Scanorama integrated object.